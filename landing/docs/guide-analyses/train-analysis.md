---
sidebar_position: 2
---

# 추론하기

이 페이지는 사용자가 캔버스에서 구성한 모델의 학습 결과를 활용하여 원하는 에포크에서 이미지를 추론하고 결과를 확인할 수 있도록 설계되었습니다.

---

## 주요 기능

### 1. 모델 확인

- **모델 시각화**: 캔버스에서 구성한 모델이 추론 페이지에 그대로 표시됩니다.
- **수정 불가**: 추론 페이지에서는 모델의 위치와 엣지(Edge)를 수정할 수 없습니다.
- **정렬 기능**: 좌측 상단의 정렬 버튼을 통해 모델을 가로 또는 세로로 정렬할 수 있습니다.
  - 정렬은 `d3-hierarchy` 알고리즘을 사용하여 수행됩니다.


### 2. 에포크 리스트

- 좌측에 에포크 리스트가 표시되며, 학습 과정에서 설정한 에포크 횟수는 10단위로 나뉘어 리스트에 추가됩니다.
- **상단 고정 에포크**:
  - `train_best`: Train Loss가 가장 낮은 시점의 모델.
  - `valid_best`: Validation Loss가 가장 낮은 시점의 모델.
  - `final`: 학습이 종료된 시점의 모델.
- 사용자는 추론하고자 하는 에포크를 선택할 수 있습니다.


### 3. 추론 준비

- **데이터 타입 노드**: 모델의 **출발점 노드**로, 항상 기본적으로 존재하며 단 하나만 있습니다.
  - 이 노드에서 테스트할 이미지를 1개 선택합니다.
- **추론 버튼**: 선택한 이미지와 에포크를 바탕으로 추론을 시작할 수 있습니다.


### 4. 디바이스 선택

- 추론 버튼 클릭 후, 추론에 사용할 디바이스를 선택합니다.
  - **CPU**
  - **GPU**
- 디바이스 선택이 완료되면 추론이 진행됩니다.


### 5. 추론 결과

- 추론 결과는 블럭의 타입에 따라 다음과 같이 표시됩니다:
  - **Conv2D**:
    - Feature Map: 해당 노드의 활성화 맵(Feature Map)을 확인할 수 있습니다.
  - **최종 연산 블럭**:
    - Heatmap 이미지: 추론 결과로 생성된 시각화 이미지.
    - Class Score: 상위 3개의 클래스와 해당 확률이 표시됩니다.

---

## 사용 예시

1. 캔버스에서 구성한 모델을 학습 후, 학습 기록에서 추론하기 페이지로 이동합니다.
2. 좌측 에포크 리스트에서 원하는 에포크를 선택합니다.
3. 데이터 타입 노드에서 테스트 이미지를 1개 선택합니다.
4. 추론하기 버튼을 클릭한 뒤 디바이스를 선택합니다.
5. 추론 결과를 확인하며, Activation 노드에서 Heatmap과 Class Score를, Conv2D 노드에서 Feature Map을 확인합니다.

---

추론하기 페이지는 사용자가 학습된 모델의 성능을 다양한 방식으로 검증하고, 모델의 작동 방식을 시각적으로 이해할 수 있도록 돕습니다.
